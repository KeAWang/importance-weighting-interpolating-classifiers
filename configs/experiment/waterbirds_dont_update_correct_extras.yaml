# @package _global_

# to execute this experiment run:
# python run.py +experiment=waterbirds_erm

defaults:
    - /datamodule: waterbirds_datamodule.yaml
    - /model: imbalanced_classifier_model.yaml
    - /optimizer: sgd.yaml
    - /architecture: res_net.yaml
    - /loss_fn: cross_entropy.yaml

logger:
    wandb:
        tags: ["binary", "waterbirds", "undersampled-with-extras"]

load_wandb_run: ["kealexanderwang", "importance-reweighing", "waterbirds-undersampled-493", "last.ckpt"]

callbacks:
    group_train_accuracy_monitor:
        _target_: src.pl_callbacks.metrics_callbacks.GroupTrainAccuracyMonitor
    group_val_accuracy_monitor:
        _target_: src.pl_callbacks.metrics_callbacks.GroupValReweightedAccuracyMonitor

trainer:
    min_epochs: 1
    max_epochs: 50

datamodule:
    wrapper_type: undersampled_with_extras

    resolution: [224, 224]
    batch_size: 64
    num_workers: 4
    pin_memory: True
    flatten_input: False

model:
    dont_update_correct_extras: True

optimizer:
    lr: 0.001
    momentum: 0.9
    weight_decay: 0.0001

architecture:
    arch: resnet50
