# @package _global_

defaults:
    - /datamodule: waterbirds_datamodule.yaml
    - /model: imbalanced_classifier_model.yaml
    - /optimizer: sgd.yaml                    
    - /architecture: res_net.yaml                 
    - /loss_fn: polynomial_loss.yaml

logger:
    wandb:
        tags: ["binary", "waterbirds", "dro", "poly"]

trainer:
    min_epochs: 1
    max_epochs: 200

datamodule:
    wrapper_type: reweighted
    resolution: [224, 224]
    batch_size: 64
    num_workers: 4
    pin_memory: True
    flatten_input: False

optimizer:
    lr: 0.0005
    momentum: 0.9

architecture:
    arch: resnet50
    pretrained: False

loss_fn:
    alpha: 2.

model:
    dro: True
    adv_probs_lr: 0.01
    reweight_loss: False
